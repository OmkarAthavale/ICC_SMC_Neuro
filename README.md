# ICC_SMC_Neuro

Reproduces data from [1].

Run scripts in the sequence shown below to reproduce data and figures - figures are saved in generated_fig. 
Outputs for scripts 1-4 are provided, and scripts can be run starting at 5 to generate figures without re-generating data outputs. 
Note that Figure 1 is a model illustration, not a simulation result and cannot be generated programmatically.  

### Data generation scripts
1. Parameter optimisation procedure step 1: parameter_optimisation/optim_ICC.m
2. Parameter optimisation procedure step 2: parameter_optimisation/optim_SMC.m
3. Sensitivity analysis sampling: sensitivity_analysis/SA1_sampling.py
4. Sensitivity analysis parallel simulation: sensitivity_analysis/parallel_SA_simulate.m

### Plotting scripts
5. Figure 2A: figure_generation/baseline_plotter.m (this script also outputs quantified values to the MATLAB console)
6. Figure 2B: figure_generation/aligned_event_plot.m
7. Figure 3: figure_generation/parameter_sweep_1D_combinedPlot.m
8. Figure 4: figure_generation/optimisation_results.m (this script also outputs exact fitted values to the MATLAB console)
9. Figure 5A-B: figure_generation/dosage_sweep_plot.m
10. Figure 5C: figure_generation/stimulation_plotter.m
11. Figure 6: sensitivity_analysis/SA2_analysis_plot.py

### Other scripts
parameter_optimisation/plot_coverage.m: Plots the resampled marginal change in optimised parameter values per iteration. 
figure_generation/parameter_sweep.m: generates data of 1D or 2D parameter sweeps for any selected range fo parameter values. 
figure_generation/sweep_2D_plots.m: plots 2D parameter sweeps generated by figure_generation/parameter_sweep.m. Can overlay fitted parameter values. 

### Provided intermediate outputs
The following large or computationally expensive data outputs are provided for convenience:
1. data/optim_ICC_data.mat: Parameter optimisation step 1
2. data/optim_SMC_data.mat: Parameter optimisation step 2
3. sensitivity_analysis/param_values.txt: Sobol sampled parameter values for variance based sensitivity analysis
4. sensitivity_analysis/output_frequency.txt: Model result (tension frequency) for simulations with the Sobol sampled parameter values for variance based sensitivity analysis
5. sensitivity_analysis/output_plateau.txt: Model result (tension plateau amplitude) for simulations with the Sobol sampled parameter values for variance based sensitivity analysis

### Dependencies
The following MATLAB toolboxes are required to run the MATLAB scripts as is: Statistics, Signal Processing, Parallel Computing, Optimization.
The following Python libraries are required to run the sensitivity analysis Python scripts as is: numpy, matplotlib, SALib. These can be installed via pip from PyPI.

### References
[1] Athavale, O. N., Avci, R., Clark, A. R., Di Natale, M. R., Wang, X., Furness, J. B., Liu, Z., Cheng, L. K., & Du, P. Neural regulation of slow waves and phasic contractions in the distal stomach: A mathematical model. Unpublished.
